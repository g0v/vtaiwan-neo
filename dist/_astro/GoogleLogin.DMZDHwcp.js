import{o as c,r as d,a as h,s as p,f,G as _,u as S,d as y,c as s}from"./firebase.Dd7E2CAK.js";import{_ as k}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as a,t as m,a as L,r as n,o as x,f as l}from"./runtime-core.esm-bundler.CxImSglf.js";const w={__name:"GoogleLogin",setup(b,{expose:g}){g();const r=n(null),e=n(!1);x(()=>{console.log("Setting up auth state listener"),c(s,async o=>{console.log("Auth state changed:",o),r.value=o})});const i={user:r,isLoading:e,handleGoogleLogin:async()=>{try{console.log("Starting Google login..."),e.value=!0;const o=new _,t=await f(s,o);console.log("Google login successful:",t.user);const u={name:t.user.displayName,email:t.user.email,photoURL:t.user.photoURL,lastLogin:new Date().toISOString()};console.log("Saving user data:",u),await h(d(y,`users/${t.user.uid}`),u),console.log("User data saved successfully")}catch(o){console.error("Google login error:",o),alert("登入時發生錯誤，請稍後再試")}finally{e.value=!1}},handleLogout:async()=>{try{console.log("Logging out..."),await p(s),console.log("Logout successful")}catch(o){console.error("Logout error:",o),alert("登出時發生錯誤，請稍後再試")}},ref:n,onMounted:x,get auth(){return s},get database(){return y},get usersRef(){return S},get GoogleAuthProvider(){return _},get signInWithPopup(){return f},get signOut(){return p},get onAuthStateChanged(){return c},get set(){return h},get dbRef(){return d}};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}},A=["disabled"],P={key:1,class:"flex items-center space-x-4"},R={class:"text-gray-700"};function C(b,g,r,e,v,G){return l(),a("div",null,[e.user?(l(),a("div",P,[L("span",R,"歡迎，"+m(e.user.displayName),1),L("button",{onClick:e.handleLogout,class:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800"}," 登出 ")])):(l(),a("button",{key:0,onClick:e.handleGoogleLogin,class:"flex items-center px-4 py-2 bg-orange-500 text-white border border-gray-300 rounded-md text-gray-700 hover:bg-black transition-colors",disabled:e.isLoading},m(e.isLoading?"登入中...":"使用 Google 登入"),9,A))])}const I=k(w,[["render",C]]);export{I as default};
